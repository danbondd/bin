#!/usr/bin/env bash

set -e

# get the primary display
PRIMARY=$(xrandr | grep "^eDP-[0-9] connected" | awk '{print $1}')
if [ -z "${PRIMARY}" ]; then
	echo "could not determine primary display"
	exit 1
fi

# check for an external display
EXTERNAL=$(xrandr | grep "^DP-[0-9] connected" | awk '{print $1}')

function usage {
	echo "Usage: $(basename $0) [OPTION]"
	echo "Control internal and external display settings."
	echo ""
	echo "OPTIONS"
	echo "  both       turn both primary and extarnal displays on"
	echo "  primary    turn on primary display only"
	echo "  external   turn on external display only"
	exit 1
}

case "$1" in
	both)
		xrandr --output ${PRIMARY} --primary --auto --left-of ${EXTERNAL} --output ${EXTERNAL} --auto
		i3-msg restart
		;;
	primary)
		xrandr --output ${PRIMARY} --auto --primary --output ${EXTERNAL} --auto --off
		i3-msg restart
		;;
	external)
		xrandr --output ${PRIMARY} --off --output ${EXTERNAL} --auto --primary
		i3-msg restart
		;;
	*)
		usage
		;;
esac

#!/usr/bin/env bash

set -eo pipefail

# get the primary display
PRIMARY=$(xrandr | grep "^eDP-[0-9] connected" | awk '{print $1}')
if [ -z "${PRIMARY}" ]; then
	echo "could not determine primary display"
	exit 1
fi

# check for external HDMI or DP displays and return first entry
EXTERNAL=$(xrandr | grep -E "^(DP|HDMI)-[0-9] connected" | head -n1 | awk '{print $1}')

function usage {
	echo "Usage: $(basename $0) [OPTION]"
	echo "Control internal and external display settings."
	echo ""
	echo "OPTIONS"
	echo "  dual       turn both primary and extarnal displays on"
	echo "  primary    turn on primary display only"
	echo "  external   turn on external display only"
	exit 1
}

case "$1" in
	dual)
		xrandr --output ${PRIMARY} --auto --left-of ${EXTERNAL} --output ${EXTERNAL} --auto --primary
		;;
	primary)
		xrandr --output ${PRIMARY} --auto --primary --output ${EXTERNAL} --auto --off
		;;
	external)
		xrandr --output ${PRIMARY} --off --output ${EXTERNAL} --auto --primary
		;;
	*)
		usage
		;;
esac

# restart i3 on display update
i3-msg restart
